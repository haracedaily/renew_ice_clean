<!doctype html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>ICECARE 예약조회</title>
    <link rel="icon" type="image/png" href="/favicon.png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css"/>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <link rel="stylesheet" href="./css/reservationInquiry.css">
    <link rel="stylesheet" href="./css/reservationInmedia.css">
    <link rel="stylesheet" href="./css/common.css">
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <script src="https://t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script>
        // Supabase 클라이언트 초기화를 DOMContentLoaded 이벤트에서 실행
        document.addEventListener('DOMContentLoaded', function() {
            const supabaseUrl = 'https://wqetnltlnsvjidubewia.supabase.co';
            const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6IndxZXRubHRsbnN2amlkdWJld2lhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDI3NzI5NDksImV4cCI6MjA1ODM0ODk0OX0.-Jw0jqyq93rA7t194Kq4_umPoTci8Eqx9j-oCwoZc6k';
            window.supabase = supabase.createClient(supabaseUrl, supabaseKey);
        });
        
        // 로그인 체크 및 리다이렉트 함수
        function checkLoginAndRedirect(targetUrl) {
            // 로컬 스토리지에서 로그인 정보 확인
            const userInfo = localStorage.getItem('userInfo');
            const isLoggedIn = localStorage.getItem('isLoggedIn');
            
            if (!isLoggedIn || !userInfo) {
                // 로그인되지 않은 경우 로그인 페이지로 리다이렉트
                Swal.fire({
                    icon: 'warning',
                    title: '로그인이 필요합니다',
                    text: '예약 서비스를 이용하려면 로그인이 필요합니다.',
                    confirmButtonText: '로그인하기',
                    showCancelButton: true,
                    cancelButtonText: '취소',
                    confirmButtonColor: '#0066CC',
                    customClass: {
                        icon: 'swal2-icon-custom'
                    }
                }).then((result) => {
                    if (result.isConfirmed) {
                        // 로그인 페이지로 이동
                        window.location.href = './mypage.html';
                    }
                });
                return false;
            }
            
            // 로그인된 경우 목표 페이지로 이동
            window.location.href = targetUrl;
            return true;
        }
        
        // SweetAlert 아이콘 커스텀 스타일
        const style = document.createElement('style');
        style.textContent = `
            .swal2-icon-custom {
                color: #0066CC !important;
            }
            .swal2-icon-custom .swal2-icon-content {
                color: #0066CC !important;
            }
            div:where(.swal2-icon).swal2-warning {
                border-color: #0066CC !important;
            }
            div:where(.swal2-icon).swal2-warning [class^='swal2-warning-circular-line'] {
                border-color: #0066CC !important;
            }
        `;
        document.head.appendChild(style);
    </script>
</head>
<body>
<!--    <nav>-->

<header class="sticky top-0 z-40 w-full bg-white p-5">
    <nav class="flex items-center justify-between max-w-[1200px] mx-auto">
        <img src="./image/logo.png" class="cursor-pointer" onclick="location.href='./index.html'" alt="">
        <ul class="flex gap-8">
            <li><a href="./contact_us.html" class="nav-link">공지사항</a></li>
            <li><a href="./contact_us.html?pageNum=1&category_id=2" class="nav-link">FAQ</a></li>
            <li><a href="#" class="nav-link" onclick="checkLoginAndRedirect('./reservation.html')">예약하기</a></li>
            <li><a href="./mypage.html" class="nav-link" style="display: inline-flex; align-items: center; white-space: nowrap;"><img src="./image/mypage.png" alt="마이페이지" style="margin-right: 5px;"> MY</a></li>
        </ul>
    </nav>
    <!--  <div id="side_btn_group" class="h-full absolute right-[5%] top-60 z-50 flex flex-col justify-between items-center">
      <div id="notice_btn" class="rounded-[25px] w-[50px] h-[50px] mb-10 z-50 flex justify-center items-center" onclick="location.href='./contact_us.html'">
          <span class="flex justify-center items-center"><h5 class="h-[38px]">&lt;</h5></span>
          <p>공지사항</p>
      </div>
      <div id="kakaoBot_btn" class="rounded-[25px] w-[50px] h-[50px] z-50 flex justify-center items-center" onclick="location.href='#'">
          <p>카카오챗봇</p>
      </div>
      </div>
  -->
    <div id="side_btn_group"
         class="w-[45px] h-[100px] rounded-[20px] z-50 absolute top-[70vh] right-10 flex flex-col justify-evenly items-center">
        <span class="w-[35px] h-[35px] rounded-[50%] border border-white flex justify-start items-center cursor-pointer"
              onclick="window.scrollTo({top:0,behavior:'smooth'})">
            <p class="text-white text-xl rotate-90 pb-[17px]">&lt;</p>
        </span>
        <!--   <span class="w-[35px] h-[35px] rounded-[50%] flex justify-center items-center bg-[url('./image/whiteBalloon.png')] bg-no-repeat cursor-pointer"
                 onclick="location.href='./contact_us.html'">
               <p class="text-black text-xs font-bold tracking-[-1.2px] pb-[1.5px]">Q&A</p>
           </span>-->
        <span class="w-[35px] h-[35px] rounded-[50%] flex justify-center items-center bg-[url('./image/darkBalloon.png')] bg-no-repeat cursor-pointer"
              onclick="window.open('http://pf.kakao.com/_Kxgsxfn','_blank','width=500,height=630')">
            <p class="text-white text-xs font-bold tracking-[-0.5px] pl-[3px] pb-[2px]">Ch+</p>
        </span>

    </div>

</header>

    <div id="container">
        <div class="toptxt">
            <h1>아이스케어 <br/>나의 예약 내역 확인하기 </h1>
        </div>

        <div class="step01">
            <div class="m-step01" style="display: flex; width: 100%;">
                <div class="step01-left">
                    <h1 class="Q-txt" style="text-align: left">예약 정보를 입력하세요</h1>
                </div>
                <div class="step01-right">
                    <div class="form">
                        <input type="text" name="name" id="name" placeholder="이름">
                    </div>
                    <div class="form">
                        <input type="tel" name="phone" id="phone" placeholder="연락처" maxlength="13" oninput="formatPhone(this)">
                    </div>
                    <div class="form">
                        <input type="email" name="email" id="email" placeholder="email">
                    </div>
                </div>
            </div>
            <div class="privacy-check">
                <input type="checkbox" name="privacy" id="privacy" class="cursor-pointer">
                <label class="agree" for="privacy">개인정보 제공에 동의합니다 </label>
                <button class="privacy-detail-btn">[보기]</button>
            </div>
            <div class="privacy-details hidden2" id="privacy-details" style="margin-top: 2rem">
                <p><strong>1. 개인정보 수집 및 이용 목적</strong><br>
                    ICECARE는 제빙기 청소 및 수리 서비스 예약, 제공, 고객 문의 응대, 품질 향상을 위해 개인정보를 수집·이용합니다.</p>
                <p><strong>2. 수집하는 개인정보 항목</strong><br>
                    - 필수: 성명, 연락처, 이메일, 서비스 주소, 예약 일시, 제빙기 모델명, 서비스 요청 세부 사항 등</p>
                <p><strong>3. 보유 및 이용 기간</strong><br>
                    서비스 제공 완료 후 1년 (법령에 따른 보존 기간 예외)</p>
                <p><strong>4. 개인정보 제공</strong><br>
                    - 제공받는 자: ICECARE 협력업체, 제빙기 제조사<br>
                    - 목적: 예약 조율, 현장 서비스, 부품 수급<br>
                    - 항목: 성명, 연락처, 주소, 모델명 등</p>
                <p><strong>5. 동의 철회</strong><br>
                    언제든지 동의를 철회하거나 열람·정정을 요청할 수 있습니다 <br/>(고객센터: 1234-5678)</p>
            </div>
            <button class="gobtn" style="margin-top: 2rem" >조회하기</button>
        </div><!--step01-->
        <div class="step02">


        </div><!-- step02-->
    </div><!--container-->
</body>
</html>
<script>
    // function slideMenu() {
    //     const navLinks = document.querySelector('.m-nav-links');
    //     const overlay = document.querySelector('.overlay');
    //
    //     navLinks.classList.toggle('active');
    //     overlay.classList.toggle('active');
    // }

        function formatPhone(input) {
        let value = input.value.replace(/\D/g, '');
        if (value.length > 3 && value.length <= 7) {
        value = `${value.slice(0, 3)}-${value.slice(3)}`;
    } else if (value.length > 7) {
        value = `${value.slice(0, 3)}-${value.slice(3, 7)}-${value.slice(7, 11)}`;
    }

        input.value = value;
    }
</script>
<script src="./js/reservationInquiry.js"></script>